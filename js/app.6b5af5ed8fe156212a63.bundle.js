(self.webpackChunk=self.webpackChunk||[]).push([[143],{138:(e,t,o)=>{const n=o(809),{AxisScrollStrategies:i,AxisTickStrategies:a,emptyTick:s,AutoCursorModes:l,FormattingFunctions:r,LUT:c,lightningChart:d,UIElementBuilders:u,UILayoutBuilders:g,PointShape:p,ColorCSS:m,ColorRGBA:y,emptyFill:x,PalettedFill:h,SolidFill:f,emptyLine:S,synchronizeAxisIntervals:v,translatePoint:b,transparentFill:w,UIOrigins:T,MouseStyles:k,SolidLine:_,UIDraggingModes:M,Themes:I}=n,C=d().Dashboard({numberOfColumns:1,numberOfRows:4});let F=!0;const D=new c({interpolate:!0,steps:[{value:-1,color:y(0,0,0)},{value:-.1,color:y(0,0,0)},{value:0,color:y(255,255,0)},{value:1e3,color:y(255,0,0)}]}),A=new c({interpolate:!0,steps:[{value:-1,color:y(0,0,0,100)},{value:-.1,color:y(0,0,0,100)},{value:0,color:y(255,0,0,100)},{value:50,color:y(255,255,0,100)},{value:100,color:y(0,255,0,100)}]}),E={World:[{mapType:"NorthAmerica",boundary:{bottomLeft:{x:4,y:52},topRight:{x:44,y:93}}},{mapType:"SouthAmerica",boundary:{bottomLeft:{x:16,y:14},topRight:{x:45,y:50}}},{mapType:"Europe",boundary:{bottomLeft:{x:45,y:64},topRight:{x:60,y:93}}},{mapType:"Africa",boundary:{bottomLeft:{x:46,y:15},topRight:{x:63,y:64}}},{mapType:"Asia",boundary:{bottomLeft:{x:59,y:40},topRight:{x:95,y:91}}}]},R=C.addUIElement(g.Column,C.uiScale).setOrigin(T.RightTop).setPosition(b({x:C.engine.container.getBoundingClientRect().width-8,y:C.engine.container.getBoundingClientRect().height-40},C.engine.scale,C.uiScale)).setBackground((e=>e.setFillStyle(x).setStrokeStyle(S))),P=R.addElement(u.TextBox).setTextFont((e=>e.setSize(10))).setText("Left click to drill down at mouse location"),L=R.addElement(u.TextBox).setTextFont((e=>e.setSize(10))).setText("Double left click to zoom out"),B=C.addUIElement(u.TextBox,C.uiScale).setOrigin(T.LeftTop).setPosition(b({x:8,y:C.engine.container.getBoundingClientRect().height-8},C.engine.scale,C.uiScale)).setText("Zoom out").setTextFont((e=>e.setSize(20))).setDraggingMode(M.notDraggable).setMouseStyle(k.Point);(async()=>{let e,t,o,n;await Promise.all([new Promise((async t=>{console.time("loading covid data"),e=await fetch(document.head.baseURI+"examples/assets/1111/owid-covid-data.json").then((e=>e.json())),console.timeEnd("loading covid data"),t()})),new Promise((async e=>{console.time("loading covid vaccinations data"),t=await fetch(document.head.baseURI+"examples/assets/1111/vaccinations.json").then((e=>e.json())),console.timeEnd("loading covid vaccinations data"),e()})),new Promise((async e=>{console.time("loading country locations data"),o=await fetch(document.head.baseURI+"examples/assets/1111/countries.json").then((e=>e.json())),console.timeEnd("loading country locations data"),e()}))]);const c=new Date(2020,10,1).getTime();let y=new Date(2022,2,11),I=X(e.FIN.data[e.FIN.data.length-1].date),R=0;const z=async s=>{R=window.performance.now(),n=n||(()=>{console.time("calculate new cases history");const o=new Map,i=new Map;for(const n of Object.keys(e)){const a=e[n];for(let e=0;e<a.data.length;e+=1){const t=a.data[e],n=t.new_cases;if(void 0!==n){const e=o.get(t.date);e?o.set(t.date,e+n):o.set(t.date,n)}}const s=t.find((e=>e.iso_code===n));for(let e=0;e<s.data.length;e+=1){const t=s.data[e],o=t.people_vaccinated_per_hundred;if(void 0!==o){const e=i.get(t.date);e?(e.count+=1,e.sum+=o):i.set(t.date,{count:1,sum:o})}}}const s=Array.from(o.entries()).map((([e,t])=>({x:X(e),y:t}))).filter((e=>e.x>=c)).sort(((e,t)=>e.x-t.x)),d=Array.from(i.entries()).map((([e,t])=>({x:X(e),y:t.sum/t.count}))).filter((e=>e.x>=c)).sort(((e,t)=>e.x-t.x));o.clear(),i.clear();const u=C.createChartXY({columnIndex:0,rowIndex:1}).setTitle("Global CoVID daily new cases history").setAutoCursorMode(l.disabled).setMouseInteractions(!1),g=u.addAxisX({opposite:!0}).setTickStrategy(a.Empty).setStrokeStyle(S).setMouseInteractions(!1),p=g.addCustomTick().setMouseInteractions(!0).setAllocatesAxisSpace(!1).setTextFormatter((e=>new Date(e).toLocaleDateString("fin",{})));v(u.getDefaultAxisX(),g),u.addLineSeries({dataPattern:{pattern:"ProgressiveX"}}).setCursorInterpolationEnabled(!1).add(s),u.getDefaultAxisY().setMouseInteractions(!1).setTitle("New daily cases").setTitleFont((e=>e.setSize(12))).setTickStrategy(a.Numeric,(e=>e.setFormattingFunction(r.NumericUnits))).fit(!1);const m=u.addAxisY({opposite:!0}).setTitle("Vaccinated once (%)").setTitleFont((e=>e.setSize(12))).setMouseInteractions(!1).setInterval(0,100,!1,!0);return u.addLineSeries({dataPattern:{pattern:"ProgressiveX"},yAxis:m}).setCursorInterpolationEnabled(!1).add(d).setStrokeStyle(new _({thickness:2,fillStyle:new h({lookUpProperty:"y",lut:A})})),u.getDefaultAxisX().setTickStrategy(a.DateTime).setMouseInteractions(!1).fit(!1),p.onMouseDrag(((e,t)=>{const o=u.engine.clientLocation2Engine(t.clientX,t.clientY),i=b(o,u.engine.scale,{x:u.getDefaultAxisX(),y:u.getDefaultAxisY()}),a=Math.min(Math.max(i.x,c),I);p.setValue(a),n.onChange&&n.onChange(a)})),p.onMouseEnter(((e,t)=>{u.engine.setMouseStyle(k.Horizontal)})),p.onMouseLeave(((e,t)=>{u.engine.setMouseStyle(k.Default)})),console.timeEnd("calculate new cases history"),n={chart:u,highlighter:p,onChange:()=>{},deactivate:()=>{u.dispose(),n=void 0}},n})(),P.restore(),"World"!==s?(L.restore(),B.restore()):(L.dispose(),B.dispose()),C.setRowHeight(0,4).setRowHeight(1,1);for(let e=2;e<4;e+=1)C.setRowHeight(e,0);const M=C.createMapChart({columnIndex:0,rowIndex:0,type:s}).setAutoCursorMode(l.disabled).setMouseInteractions(!1).setPadding({top:40}),j=C.createChartXY({columnIndex:0,rowIndex:0}).setTitle("").setBackgroundFillStyle(w).setSeriesBackgroundFillStyle(w).setAutoCursorMode(l.disabled).setMouseInteractions(!1);j.forEachAxis((e=>e.setTickStrategy(a.Empty).setStrokeStyle(S))),M.onViewChange((e=>{j.setPadding({left:e.margin.left,right:e.margin.right,top:e.margin.top,bottom:e.margin.bottom}),j.getDefaultAxisX().setInterval(e.longitudeRange.start,e.longitudeRange.end,!1,!0),j.getDefaultAxisY().setInterval(e.latitudeRange.start,e.latitudeRange.end,!1,!0)})),M.setFillStyle(new h({lut:A}));const H=j.addPointSeries({pointShape:p.Circle}).setIndividualPointSizeEnabled(!0).setIndividualPointValueEnabled(!0).setPointFillStyle(new h({lut:D})).setMouseInteractions(!1),W=(i,a=!1)=>{y=i;const l=i.getTime(),r=Y(i);M.setTitle(`CoVID vaccinations & new cases | ${i.toLocaleDateString("fin",{})}`),H.clear(),M.invalidateRegionValues(((n,i)=>{const a=n.ISO_A3,c=e[a],d=t.find((e=>e.iso_code===a)),u=o.find((e=>e.cca3===a));if(c&&d&&u){const e=c.data.find((e=>e.date===r)),t=e&&e.new_cases_smoothed_per_million;let o;for(let e=d.data.length-1;e>=0;e-=1){const t=d.data[e];if(void 0!==t.people_vaccinated_per_hundred&&X(t.date)<=l){o=t.people_vaccinated_per_hundred;break}}if(void 0!==t&&void 0!==o){const e=u.latlng[0],n=u.latlng[1],i=0===t?0:O(25*t/1e3,"World"===s?1:5,25);return H.add({countryCode:a,smoothedNewCasesPerMillion:t,peopleVaccinatedPerHundred:o,x:n,y:e,value:t,size:i}),o}}return-1})),a&&n&&n.highlighter.setValue(i.getTime())};let G;W(y,!0),n.onChange=e=>{G=new Date(e)};const q=setInterval((()=>{G&&(W(G),G=void 0)}),1e3/60),Z=document.getElementById("chart-container")||document.body,J=document.createElement("div");Z.append(J);const K=d().ChartXY({container:J}).setTitle("").setPadding({left:0,bottom:0,right:0,top:14}).setMouseInteractions(!1);K.setBackgroundFillStyle(x).setSeriesBackgroundFillStyle(x),K.engine.setBackgroundFillStyle(x),K.getDefaultAxisY().dispose(),K.getDefaultAxisX().setAnimationScroll(!1);const Q=K.addUIElement(g.Column).setPosition({x:0,y:100}).setOrigin(T.LeftTop).setBackground((e=>e.setStrokeStyle(S).setFillStyle(x))),ee=e=>Q.addElement(u.TextBox).setText(e),te=ee("");U(K.getTheme())||te.setTextFillStyle(new f({color:m("rgb(255,255,255)")}));const oe=(e,t,o,n,a)=>{const s=new f({color:m(e)}),l=K.addAxisY().setInterval(0,o).setScrollStrategy(i.expansion);return{series:K.addLineSeries({yAxis:l,dataPattern:{pattern:"ProgressiveX"}}).setCursorInterpolationEnabled(!1).setStrokeStyle((e=>e.setFillStyle(s))),label:ee(t).setTextFillStyle(s),valueLabel:K.addUIElement(u.TextBox,{x:K.getDefaultAxisX(),y:l}).setOrigin(T.RightBottom).setTextFillStyle(s).setText("").setBackground((e=>e.setStrokeStyle(S).setFillStyle(x))),format:n,dataSet:a}},ne={people_vaccinated_per_hundred:oe("rgb(0, 255, 0)","Vaccinations",100,(e=>void 0!==e.people_vaccinated_per_hundred?`${e.people_vaccinated_per_hundred.toFixed(1)}%`:void 0),t),new_cases_per_million:oe("rgb(255, 255, 0)","New cases",1e3,(e=>void 0!==e.new_cases?String(e.new_cases):void 0),e),hosp_patients_per_million:oe("rgb(255, 127, 0)","Hospitalized",100,(e=>void 0!==e.hosp_patients?String(e.hosp_patients):void 0),e),icu_patients_per_million:oe("rgb(255, 0, 0)","Severe cases",50,(e=>void 0!==e.icu_patients?String(e.icu_patients):void 0),e)};let ie,ae,se;J.style.position="absolute",J.style.backgroundColor="rgba(0,0,0,0.7)",J.style.border="solid 8px transparent",J.style.borderRadius="16px",J.style.width="280px",J.style.height="200px",J.style.transition="left 0.2s, top 0.2s, opacity 0.5s",J.style.opacity="0.0",J.style.pointerEvents="none",K.forEachAxis((e=>e.setTickStrategy(a.Empty).setStrokeStyle(S).setMouseInteractions(!1))),j.onSeriesBackgroundMouseMove(((e,t)=>{const o=H.solveNearestFromScreen(j.engine.clientLocation2Engine(t.clientX,t.clientY));o&&(ie=o.location,se=ie.countryCode)})),j.onSeriesBackgroundMouseLeave((()=>{ae=void 0,ie=void 0}));const le=setInterval((()=>{if(ie&&ie.countryCode!==ae){const n=b({x:ie.x,y:ie.y},{x:j.getDefaultAxisX(),y:j.getDefaultAxisY()},j.engine.scale),i=j.engine.engineLocation2Client(n.x,n.y),a=Z.getBoundingClientRect();J.style.left=`${Math.max(i.x-(290+a.left),10)}px`,J.style.top=`${Math.max(i.y-(210+a.top),10)}px`,J.style.opacity="1.0",K.engine.layout();const s=30,l=e[ie.countryCode],r=t.find((e=>e.iso_code===ie.countryCode)),c=o.find((e=>e.cca3===ie.countryCode));te.setText(`${c.name.common} previous 4 weeks`);const d=N(new Date(y.getTime()-24*s*60*60*1e3),y),u=l.data.filter((e=>d(e.date))),g=r.data.filter((e=>d(e.date)));for(const t of Object.keys(ne)){const{series:o,valueLabel:n,dataSet:i,format:a}=ne[t],s=i===e?u:g,l=s.map((e=>({x:X(e.date),y:void 0!==e[t]?e[t]:NaN}))).filter((e=>!Number.isNaN(e.y)));let r;o.clear().add(l);for(let e=l.length-1;e>=0&&(r=l[e],Number.isNaN(r.y));e-=1);if(n.setText(""),void 0!==r){let e;for(let t=s.length-1;t>=0&&(e=a(s[t]),!e);t-=1);if(e){const t={x:r.x,y:r.y};n.setText(e).setPosition(t)}}}ae=ie.countryCode}ie=void 0,ae||(J.style.opacity="0.0")}),1e3/60);$(j.onSeriesBackgroundMouseClick.bind(j),j.onSeriesBackgroundMouseDoubleClick.bind(j),(e=>{if(window.performance.now()-R<750)return;const t=j.engine.clientLocation2Engine(e.clientX,e.clientY),o=b(t,j.engine.scale,j.uiScale),n=E[s]||[];for(const e of n)if(o.x>=e.boundary.bottomLeft.x&&o.x<=e.boundary.topRight.x&&o.y>=e.boundary.bottomLeft.y&&o.y<=e.boundary.topRight.y)return ce(),void z(e.mapType);se&&(ce(),V(se,s,F))}),(e=>{window.performance.now()-R>2e3&&"World"!==s&&(ce(),z("World"))}));const re=B.onMouseClick(((e,t)=>{"World"!==s&&window.performance.now()-R>500&&(ce(),z("World"))}));let ce=()=>{clearInterval(le),clearInterval(q),M.dispose(),j.dispose(),K.dispose(),J.remove(),B.offMouseClick(re),ce=()=>{}}},V=(l,r,d)=>{n&&n.deactivate(),P.dispose(),L.restore(),B.restore();const g=e[l],p=t.find((e=>e.iso_code===l)),m=o.find((e=>e.cca3===l)),y=(e,t,o,n,i,a)=>({property:e,dataSet:t,title:o,titleY:n,maxY:i,format:a}),h=[y("people_vaccinated_per_hundred",p,"Vaccination rate (at least 1 vaccine)","Vaccinated (%)",100,(e=>`${e.toFixed(1)}% received at least 1 vaccine`)),y(d?"new_cases_per_million":"new_cases",g,d?"New cases (relative to population)":"New cases",d?"per 1 million citizens":"New cases",d?1e3:void 0,d?e=>`${e.toFixed(0)} new cases per 1 million citizens`:e=>`${e.toFixed(0)} new cases`),y(d?"hosp_patients_per_million":"hosp_patients",g,d?"Hospital patients (relative to population)":"Hospital patients",d?"per 1 million citizens":"Hospital patients",d?100:void 0,d?e=>`${e.toFixed(0)} hospital patients per 1 million citizens`:e=>`${e.toFixed(0)} hospital patients`),y(d?"icu_patients_per_million":"icu_patients",g,d?"Intensive hospital care patients (relative to population)":"Intensive hospital care patients",d?"per 1 million citizens":"Intensive care patients",d?50:void 0,d?e=>`${e.toFixed(0)} intensive care patients per 1 million citizens`:e=>`${e.toFixed(0)} intensive care patients`)].map(((e,t,o)=>{const n=C.createChartXY({columnIndex:0,rowIndex:t}).setTitle(e.title).setPadding({left:0});if(0===t){n.addUIElement(u.TextBox).setPosition({x:0,y:100}).setMargin({left:140,top:n.getTitleMarginTop()}).setOrigin(T.LeftTop).setText(`${m.name.common}`).setTextFont((e=>e.setSize(22))).setBackground((e=>e.setFillStyle(x).setStrokeStyle(S)));const e=n.addUIElement(u.TextBox).setPosition({x:100,y:100}).setOrigin(T.RightTop).setMargin({top:14,right:24}).setDraggingMode(M.notDraggable);e.onMouseEnter((e=>n.engine.setMouseStyle(k.Point))),e.onMouseLeave((e=>n.engine.setMouseStyle(k.Default)));const t=t=>{t!==F&&(F=t,D(),V(l,r,t)),e.setText(t?"Show actual values":"Show relative values")};e.onMouseClick((e=>t(!F))),t(F)}const d=n.getDefaultAxisX().setAnimationScroll(!1);t<o.length-1?d.setMouseInteractions(!1).setThickness(0).setStrokeStyle(S).setTickStrategy(a.DateTime,(e=>e.setGreatTickStyle(s).setMajorTickStyle((e=>e.setLabelFillStyle(w).setTickStyle(S))).setMinorTickStyle((e=>e.setLabelFillStyle(w).setTickStyle(S))))):d.setTickStrategy(a.DateTime);const g=n.getDefaultAxisY().setTitle(e.titleY||"").setTitleFont((e=>e.setSize(12))).setThickness({min:80});void 0!==e.maxY&&g.setInterval(0,e.maxY).setScrollStrategy(i.expansion);const p=n.addLineSeries({dataPattern:{pattern:"ProgressiveX"}}).setName(`${m.name.common}`).setCursorInterpolationEnabled(!1).setCursorResultTableFormatter(((t,o,n,i,a)=>t.addRow(`${m.name.common}`).addRow(d.formatValue(a.x)).addRow(e.format(i)))),y=e.dataSet.data.map((t=>({x:X(t.date),y:t[e.property]}))).filter((e=>void 0!==e.y&&e.x>=c));p.add(y);const h=j&&j[e.property];let f;if(h){f=n.addLineSeries({dataPattern:{pattern:"ProgressiveX"}}).setName("Global average").setCursorInterpolationEnabled(!1).setCursorResultTableFormatter(((t,o,n,i,a)=>t.addRow("Global average").addRow(d.formatValue(a.x)).addRow(e.format(i)))).add(h);const t=p.getStrokeStyle();f.setStrokeStyle(t.setFillStyle(t.getFillStyle().setA(100)))}return{...e,chart:n,series:p,seriesAverage:f}}));v(...h.map((e=>e.chart.getDefaultAxisX())));for(let e=0;e<4;e+=1)C.setRowHeight(e,e<h.length?1:0);const f=Date.now()+864e5,b=c;h[0].chart.getDefaultAxisX().setInterval(b,f,!1,!0);const _=()=>{D&&D(),z(r)};h.forEach((e=>{$(e.chart.onSeriesBackgroundMouseClick.bind(e.chart),e.chart.onSeriesBackgroundMouseDoubleClick.bind(e.chart),(e=>{}),_),$(e.chart.onBackgroundMouseClick.bind(e.chart),e.chart.onBackgroundMouseDoubleClick.bind(e.chart),(e=>{}),_)}));const I=B.onMouseClick((()=>_()));let D=()=>{h.forEach((e=>{e.chart.dispose()})),B.offMouseClick(I),D=void 0};R=window.performance.now()};let j;console.time("calculate global averages"),j={new_cases_per_million:[],hosp_patients_per_million:[],icu_patients_per_million:[]};for(const t of Object.keys(j)){const o=new Map;for(const n of Object.keys(e)){const i=e[n];if(i)for(let e=0;e<i.data.length;e+=1){const n=i.data[e],a=n[t];if(void 0!==a){const e=o.get(n.date);e?(e.count+=1,e.sum+=a):o.set(n.date,{count:1,sum:a})}}}const n=Array.from(o.entries()).map((([e,t])=>({x:X(e),y:t.sum/t.count}))).sort(((e,t)=>e.x-t.x)).filter((e=>e.x>=c));j[t]=n}console.timeEnd("calculate global averages"),z("World")})();const N=(e,t)=>{const o=e.getFullYear(),n=e.getMonth(),i=e.getDate(),a=t.getFullYear(),s=t.getMonth(),l=t.getDate(),r=372*o+31*n+i,c=372*a+31*s+l;return e=>{const t=372*Number(e.substring(0,4))+31*(Number(e.substring(5,7))-1)+Number(e.substring(8,10));return t>=r&&t<=c}},X=e=>{const t=Number(e.substring(0,4)),o=Number(e.substring(5,7))-1,n=Number(e.substring(8,10));return new Date(t,o,n).getTime()},Y=e=>`${e.getFullYear()}-${z(e.getMonth()+1,2)}-${z(e.getDate(),2)}`,z=(e,t)=>{let o=String(e);for(;o.length<t;)o=`0${o}`;return o},$=(e,t,o,n)=>{let i=0;e(((e,t)=>{setTimeout((()=>{window.performance.now()-i>=500&&o(t)}),200)})),t(((e,t)=>{i=window.performance.now(),n(t)}))},O=(e,t,o)=>Math.min(Math.max(e,t),o),U=e=>[I.darkGold,I.darkGreen,I.darkLime,I.darkMagenta,I.darkRed,I.darkTurquoise,I.darkNature,I.blueSciFiNew].includes(e)}},e=>{e.O(0,[736],(()=>(138,e(e.s=138)))),e.O()}]);