(self.webpackChunk=self.webpackChunk||[]).push([[524],{44:(e,t,o)=>{const n=o(377),{AxisScrollStrategies:i,AxisTickStrategies:s,emptyTick:a,AutoCursorModes:r,FormattingFunctions:l,LUT:d,lightningChart:c,UIElementBuilders:p,UILayoutBuilders:u,PointShape:g,ColorCSS:m,ColorRGBA:y,emptyFill:v,PalettedFill:x,SolidFill:h,emptyLine:S,synchronizeAxisIntervals:f,transparentFill:w,UIOrigins:b,MouseStyles:T,SolidLine:k,UIDraggingModes:_,Themes:L,regularColorSteps:A}=n,F=c({resourcesBaseUrl:new URL(document.head.baseURI).origin+new URL(document.head.baseURI).pathname+"resources/"}).Dashboard({numberOfColumns:1,numberOfRows:4,theme:L[new URLSearchParams(window.location.search).get("theme")||"darkGold"]||void 0}),E=F.getTheme();let I=!0;const P=new d({interpolate:!0,steps:[{value:-1,color:y(0,0,0)},{value:-.1,color:y(0,0,0)},...A(0,1e3,E.examples.badGoodColorPalette.reverse())]}),R=new d({interpolate:!0,steps:[{value:-1,color:y(0,0,0)},{value:-.1,color:y(0,0,0)},...A(0,100,E.examples.badGoodColorPalette.reverse())]}),C={World:[{mapType:"NorthAmerica",boundary:{bottomLeft:{x:.04,y:.52},topRight:{x:.44,y:.93}}},{mapType:"SouthAmerica",boundary:{bottomLeft:{x:.16,y:.14},topRight:{x:.45,y:.5}}},{mapType:"Europe",boundary:{bottomLeft:{x:.45,y:.64},topRight:{x:.6,y:.93}}},{mapType:"Africa",boundary:{bottomLeft:{x:.46,y:.15},topRight:{x:.63,y:.64}}},{mapType:"Asia",boundary:{bottomLeft:{x:.59,y:.4},topRight:{x:.95,y:.91}}}]},D=F.addUIElement(u.Column,F.coordsRelative).setOrigin(b.RightTop).setBackground((e=>e.setFillStyle(v).setStrokeStyle(S))),U=D.addElement(p.TextBox).setTextFont((e=>e.setSize(10))).setText("Left click to drill down at mouse location"),B=D.addElement(p.TextBox).setTextFont((e=>e.setSize(10))).setText("Double left click to zoom out"),N=F.addUIElement(p.TextBox,F.coordsRelative).setOrigin(b.LeftTop).setText("Zoom out").setTextFont((e=>e.setSize(20))).setDraggingMode(_.notDraggable).setMouseStyle(T.Point);F.addEventListener("resize",(e=>{const t=F.engine.container.getBoundingClientRect();D.setPosition({x:t.width-8,y:t.height-40}),N.setPosition({x:8,y:t.height-8})})),(async()=>{let e,t,o,n;await Promise.all([new Promise((async t=>{console.time("loading covid data"),e=await fetch(new URL(document.head.baseURI).origin+new URL(document.head.baseURI).pathname+"examples/assets/1111/owid-covid-data.json").then((e=>e.json())),console.timeEnd("loading covid data"),t()})),new Promise((async e=>{console.time("loading covid vaccinations data"),t=await fetch(new URL(document.head.baseURI).origin+new URL(document.head.baseURI).pathname+"examples/assets/1111/vaccinations.json").then((e=>e.json())),console.timeEnd("loading covid vaccinations data"),e()})),new Promise((async e=>{console.time("loading country locations data"),o=await fetch(new URL(document.head.baseURI).origin+new URL(document.head.baseURI).pathname+"examples/assets/1111/countries.json").then((e=>e.json())),console.timeEnd("loading country locations data"),e()}))]);const r=new Date(2020,10,1).getTime();let d=new Date(2022,2,11),g=z(e.FIN.data[e.FIN.data.length-1].date),y=0;const L=async a=>{y=window.performance.now(),n=n||(()=>{console.time("calculate new cases history");const o=new Map,i=new Map;for(const n of Object.keys(e)){const s=e[n];for(let e=0;e<s.data.length;e+=1){const t=s.data[e],n=t.new_cases;if(void 0!==n){const e=o.get(t.date);e?o.set(t.date,e+n):o.set(t.date,n)}}const a=t.find((e=>e.iso_code===n));for(let e=0;e<a.data.length;e+=1){const t=a.data[e],o=t.people_vaccinated_per_hundred;if(void 0!==o){const e=i.get(t.date);e?(e.count+=1,e.sum+=o):i.set(t.date,{count:1,sum:o})}}}const a=Array.from(o.entries()).map((([e,t])=>({x:z(e),y:t}))).filter((e=>e.x>=r)).sort(((e,t)=>e.x-t.x)),d=Array.from(i.entries()).map((([e,t])=>({x:z(e),y:t.sum/t.count}))).filter((e=>e.x>=r)).sort(((e,t)=>e.x-t.x));o.clear(),i.clear();const c=F.createChartXY({columnIndex:0,rowIndex:1}).setTitle("Global CoVID daily new cases history").setCursorMode(void 0).setUserInteractions(void 0),u=c.addAxisX({opposite:!0}).setTickStrategy(s.Empty).setStrokeStyle(S),m=u.addCustomTick(p.PointableTextBox).setAllocatesAxisSpace(!1).setTextFormatter((e=>new Date(e).toLocaleDateString("fin",{})));f(c.getDefaultAxisX(),u),c.addPointLineAreaSeries({dataPattern:"ProgressiveX"}).setAreaFillStyle(v).appendJSON(a),c.getDefaultAxisY().setTitle("New daily cases").setTitleFont((e=>e.setSize(12))).setTickStrategy(s.Numeric,(e=>e.setFormattingFunction(l.NumericUnits))).fit(!1);const y=c.addAxisY({opposite:!0}).setTitle("Vaccinated once (%)").setTitleFont((e=>e.setSize(12))).setInterval({start:0,end:100});return c.addPointLineAreaSeries({dataPattern:"ProgressiveX",yAxis:y}).setAreaFillStyle(v).appendJSON(d).setStrokeStyle(new k({thickness:2,fillStyle:new x({lookUpProperty:"y",lut:R})})),c.getDefaultAxisX().setTickStrategy(s.DateTime).fit(!1),m.addEventListener("pointerenter",(e=>{c.engine.setMouseStyle(T.Horizontal)})),m.addEventListener("pointerleave",(e=>{c.engine.setMouseStyle(T.Default)})),m.addEventListener("pointerdown",(e=>{const t=e=>{const t=c.translateCoordinate(e,c.coordsAxis),o=Math.min(Math.max(t.x,r),g);m.setValue(o),n.onChange&&n.onChange(o)},o=e=>{document.body.removeEventListener("pointermove",t),document.body.removeEventListener("pointerup",o)};document.body.addEventListener("pointermove",t),document.body.addEventListener("pointerup",o)})),console.timeEnd("calculate new cases history"),n={chart:c,highlighter:m,onChange:()=>{},deactivate:()=>{c.dispose(),n=void 0}},n})(),U.setVisible(!0),"World"!==a?(B.setVisible(!0),N.setVisible(!0)):(B.setVisible(!1),N.setVisible(!1)),F.setRowHeight(0,4).setRowHeight(1,1);for(let e=2;e<4;e+=1)F.setRowHeight(e,0);const _=F.createMapChart({columnIndex:0,rowIndex:0,type:a}).setCursorMode(void 0).setPointerEvents(!1).setPadding({top:40}),D=F.createChartXY({columnIndex:0,rowIndex:0}).setTitle("").setBackgroundFillStyle(w).setSeriesBackgroundFillStyle(w).setSeriesBackgroundStrokeStyle(S).setCursorMode(void 0).setUserInteractions(void 0);D.forEachAxis((e=>e.setTickStrategy(s.Empty).setStrokeStyle(S))),_.addEventListener("viewchange",(e=>{D.setPadding({left:e.margin.left,right:e.margin.right,top:e.margin.top,bottom:e.margin.bottom}),D.getDefaultAxisX().setInterval({start:e.longitudeRange.start,end:e.longitudeRange.end}),D.getDefaultAxisY().setInterval({start:e.latitudeRange.start,end:e.latitudeRange.end})})),_.setFillStyle(new x({lut:R}));const V=D.addPointLineAreaSeries({dataPattern:null,sizes:!0,lookupValues:!0,ids:!0}).setStrokeStyle(S).setPointFillStyle(new x({lut:P})).setPointerEvents(!1);let $=[];const j=(i,s=!1)=>{d=i;const r=i.getTime(),l=O(i);_.setTitle(`CoVID vaccinations & new cases | ${i.toLocaleDateString("fin",{})}`),V.clear();let c=0;$=[],_.invalidateRegionValues(((n,i)=>{const s=n.ISO_A3,d=e[s],p=t.find((e=>e.iso_code===s)),u=o.find((e=>e.cca3===s));if(d&&p&&u){const e=d.data.find((e=>e.date===l)),t=e&&e.new_cases_smoothed_per_million;let o;for(let e=p.data.length-1;e>=0;e-=1){const t=p.data[e];if(void 0!==t.people_vaccinated_per_hundred&&z(t.date)<=r){o=t.people_vaccinated_per_hundred;break}}if(void 0!==t&&void 0!==o){const e=u.latlng[0],i=u.latlng[1],s=0===t?0:X(25*t/1e3,"World"===a?1:5,25);return V.add({id:c,x:i,y:e,lookupValue:t,size:s}),$.push(n),c+=1,o}}return-1})),s&&n&&n.highlighter.setValue(i.getTime())};let H;j(d,!0),n.onChange=e=>{H=new Date(e)};const W=setInterval((()=>{H&&(j(H),H=void 0)}),1e3/60),G=document.getElementById("chart-container")||document.body,J=document.createElement("div");G.append(J);const Z=c().ChartXY({container:J,theme:E}).setTitle("").setPadding({left:0,bottom:0,right:0,top:14}).setUserInteractions(void 0).setBackgroundFillStyle(E.cursorResultTableFillStyle);Z.setBackgroundFillStyle(v).setBackgroundStrokeStyle(S).setSeriesBackgroundFillStyle(v).setSeriesBackgroundStrokeStyle(S),Z.engine.setBackgroundFillStyle(v),Z.getDefaultAxisY().dispose(),Z.getDefaultAxisX().setAnimationScroll(!1);const q=Z.addUIElement(u.Column).setPosition({x:0,y:100}).setOrigin(b.LeftTop).setBackground((e=>e.setStrokeStyle(S).setFillStyle(v))),K=e=>q.addElement(p.TextBox).setText(e),Q=K("");E.isDark||Q.setTextFillStyle(new h({color:m("rgb(255,255,255)")}));const ee=(e,t,o,n,s)=>{const a=new h({color:m(e)}),r=Z.addAxisY().setInterval({start:0,end:o,stopAxisAfter:!1}).setScrollStrategy(i.expansion);return{series:Z.addPointLineAreaSeries({yAxis:r,dataPattern:"ProgressiveX"}).setAreaFillStyle(v).setPointFillStyle(v).setStrokeStyle((e=>e.setFillStyle(a))),label:K(t).setTextFillStyle(a),valueLabel:Z.addUIElement(p.TextBox,{x:Z.getDefaultAxisX(),y:r}).setOrigin(b.RightBottom).setTextFillStyle(a).setText("").setBackground((e=>e.setStrokeStyle(S).setFillStyle(v))),format:n,dataSet:s}},te={people_vaccinated_per_hundred:ee("rgb(0, 255, 0)","Vaccinations",100,(e=>void 0!==e.people_vaccinated_per_hundred?`${e.people_vaccinated_per_hundred.toFixed(1)}%`:void 0),t),new_cases_per_million:ee("rgb(255, 255, 0)","New cases",1e3,(e=>void 0!==e.new_cases?String(e.new_cases):void 0),e),hosp_patients_per_million:ee("rgb(255, 127, 0)","Hospitalized",100,(e=>void 0!==e.hosp_patients?String(e.hosp_patients):void 0),e),icu_patients_per_million:ee("rgb(255, 0, 0)","Severe cases",50,(e=>void 0!==e.icu_patients?String(e.icu_patients):void 0),e)};let oe,ne,ie;J.style.position="absolute",J.style.top="0px",J.style.backgroundColor="rgba(0,0,0,0.7)",J.style.border="solid 8px transparent",J.style.borderRadius="16px",J.style.width="280px",J.style.height="200px",J.style.transition="left 0.2s, top 0.2s, opacity 0.5s",J.style.opacity="0.0",J.style.pointerEvents="none",Z.forEachAxis((e=>e.setTickStrategy(s.Empty).setStrokeStyle(S).setPointerEvents(!1))),_.addEventListener("ready",(e=>{setTimeout((()=>{oe={countryCode:"ITA",x:12.83,y:42.83}}),500)})),D.seriesBackground.addEventListener("pointermove",(e=>{const t=V.solveNearest(e),o=$[t?.id];t&&o&&(oe={countryCode:o.ISO_A3,...t},ie=oe.countryCode)})),D.seriesBackground.addEventListener("pointerleave",(e=>{ne=void 0,oe=void 0}));const se=setInterval((()=>{if(oe&&oe.countryCode!==ne){const n=D.translateCoordinate(oe,D.coordsAxis,D.coordsClient),i=G.getBoundingClientRect();J.style.left=`${Math.max(n.clientX-(290+i.left),10)}px`,J.style.top=`${Math.max(n.clientY-(210+i.top),10)}px`,J.style.opacity="1.0",Z.engine.layout();const s=30,a=e[oe.countryCode],r=t.find((e=>e.iso_code===oe.countryCode)),l=o.find((e=>e.cca3===oe.countryCode));Q.setText(`${l.name.common} previous 4 weeks`);const c=M(new Date(d.getTime()-24*s*60*60*1e3),d),p=a.data.filter((e=>c(e.date))),u=r.data.filter((e=>c(e.date)));for(const t of Object.keys(te)){const{series:o,valueLabel:n,dataSet:i,format:s}=te[t],a=i===e?p:u,r=a.map((e=>({x:z(e.date),y:void 0!==e[t]?e[t]:NaN}))).filter((e=>!Number.isNaN(e.y)));let l;o.clear().add(r);for(let e=r.length-1;e>=0&&(l=r[e],Number.isNaN(l.y));e-=1);if(n.setText(""),void 0!==l){let e;for(let t=a.length-1;t>=0&&(e=s(a[t]),!e);t-=1);if(e){const t={x:l.x,y:l.y};n.setText(e).setPosition(t)}}}ne=oe.countryCode}oe=void 0,ne||(J.style.opacity="0.0")}),1e3/60);Y(D.seriesBackground,(e=>{if(window.performance.now()-y<750)return;const t=D.translateCoordinate(e,D.coordsRelative),o=D.getSizePixels(),n=t.x/o.x,i=t.y/o.y,s=C[a]||[];for(const e of s)if(n>=e.boundary.bottomLeft.x&&n<=e.boundary.topRight.x&&i>=e.boundary.bottomLeft.y&&i<=e.boundary.topRight.y)return re(),void L(e.mapType);ie&&(re(),A(ie,a,I))}),(e=>{window.performance.now()-y>2e3&&"World"!==a&&(re(),L("World"))}));const ae=e=>{"World"!==a&&window.performance.now()-y>500&&(re(),L("World"))};N.addEventListener("click",ae);let re=()=>{clearInterval(se),clearInterval(W),_.dispose(),D.dispose(),Z.dispose(),J.remove(),N.removeEventListener("click",ae),re=()=>{}}},A=(l,d,c)=>{n&&n.deactivate(),U.setVisible(!1),B.setVisible(!0),N.setVisible(!0);const u=e[l],g=t.find((e=>e.iso_code===l)),m=o.find((e=>e.cca3===l)),x=(e,t,o,n,i,s)=>({property:e,dataSet:t,title:o,titleY:n,maxY:i,format:s}),h=[x("people_vaccinated_per_hundred",g,"Vaccination rate (at least 1 vaccine)","Vaccinated (%)",100,(e=>`${e.toFixed(1)}% received at least 1 vaccine`)),x(c?"new_cases_per_million":"new_cases",u,c?"New cases (relative to population)":"New cases",c?"per 1 million citizens":"New cases",c?1e3:void 0,c?e=>`${e.toFixed(0)} new cases per 1 million citizens`:e=>`${e.toFixed(0)} new cases`),x(c?"hosp_patients_per_million":"hosp_patients",u,c?"Hospital patients (relative to population)":"Hospital patients",c?"per 1 million citizens":"Hospital patients",c?100:void 0,c?e=>`${e.toFixed(0)} hospital patients per 1 million citizens`:e=>`${e.toFixed(0)} hospital patients`),x(c?"icu_patients_per_million":"icu_patients",u,c?"Intensive hospital care patients (relative to population)":"Intensive hospital care patients",c?"per 1 million citizens":"Intensive care patients",c?50:void 0,c?e=>`${e.toFixed(0)} intensive care patients per 1 million citizens`:e=>`${e.toFixed(0)} intensive care patients`)].map(((e,t,o)=>{const n=F.createChartXY({columnIndex:0,rowIndex:t}).setTitle(e.title).setPadding({left:0});if(0===t){const e=n.addUIElement(p.TextBox,n.coordsRelative).setText(`${m.name.common}`).setTextFont((e=>e.setSize(22))).setBackground((e=>e.setFillStyle(v).setStrokeStyle(S)));n.addEventListener("layoutchange",(t=>{e.setOrigin(b.LeftTop).setPosition({x:140,y:t.height-10})}));const t=n.addUIElement(p.TextBox).setPosition({x:100,y:100}).setOrigin(b.RightTop).setMargin({top:14,right:24}).setDraggingMode(_.notDraggable);t.addEventListener("pointerenter",(()=>n.engine.setMouseStyle(T.Point))),t.addEventListener("pointerleave",(()=>n.engine.setMouseStyle(T.Default)));const o=e=>{e!==I&&(I=e,E(),A(l,d,e)),t.setText(e?"Show actual values":"Show relative values")};t.addEventListener("click",(()=>o(!I))),o(I)}const c=n.getDefaultAxisX().setAnimationScroll(!1);t<o.length-1?c.setPointerEvents(!1).setThickness(0).setStrokeStyle(S).setTickStrategy(s.DateTime,(e=>e.setGreatTickStyle(a).setMajorTickStyle((e=>e.setLabelFillStyle(w).setTickStyle(S))).setMinorTickStyle((e=>e.setLabelFillStyle(w).setTickStyle(S))))):c.setTickStrategy(s.DateTime);const u=n.getDefaultAxisY().setTitle(e.titleY||"").setTitleFont((e=>e.setSize(12))).setThickness({min:80});void 0!==e.maxY&&u.setInterval({start:0,end:e.maxY,stopAxisAfter:!1}).setScrollStrategy(i.expansion);const g=n.addPointLineAreaSeries({dataPattern:"ProgressiveX"}).setAreaFillStyle(v).setName(`${m.name.common}`),y=e.dataSet.data.map((t=>({x:z(t.date),y:t[e.property]}))).filter((e=>void 0!==e.y&&e.x>=r));g.appendJSON(y);const x=D&&D[e.property];let h;if(x){h=n.addPointLineAreaSeries({dataPattern:"ProgressiveX"}).setAreaFillStyle(v).setName("Global average").appendJSON(x);const e=g.getStrokeStyle();h.setStrokeStyle(e.setFillStyle(e.getFillStyle().setA(100)))}return{...e,chart:n,series:g,seriesAverage:h}}));f(...h.map((e=>e.chart.getDefaultAxisX())));for(let e=0;e<4;e+=1)F.setRowHeight(e,e<h.length?1:0);const k=()=>{E&&E(),L(d)};h.forEach((e=>{Y(e.chart.seriesBackground,(e=>{}),k),Y(e.chart.background,(e=>{}),k)})),N.addEventListener("click",k);let E=()=>{h.forEach((e=>{e.chart.dispose()})),N.removeEventListener("click",k),E=void 0};y=window.performance.now()};let D;console.time("calculate global averages"),D={new_cases_per_million:[],hosp_patients_per_million:[],icu_patients_per_million:[]};for(const t of Object.keys(D)){const o=new Map;for(const n of Object.keys(e)){const i=e[n];if(i)for(let e=0;e<i.data.length;e+=1){const n=i.data[e],s=n[t];if(void 0!==s){const e=o.get(n.date);e?(e.count+=1,e.sum+=s):o.set(n.date,{count:1,sum:s})}}}const n=Array.from(o.entries()).map((([e,t])=>({x:z(e),y:t.sum/t.count}))).sort(((e,t)=>e.x-t.x)).filter((e=>e.x>=r));D[t]=n}console.timeEnd("calculate global averages"),L("World")})();const M=(e,t)=>{const o=e.getFullYear(),n=e.getMonth(),i=e.getDate(),s=t.getFullYear(),a=t.getMonth(),r=t.getDate(),l=372*o+31*n+i,d=372*s+31*a+r;return e=>{const t=372*Number(e.substring(0,4))+31*(Number(e.substring(5,7))-1)+Number(e.substring(8,10));return t>=l&&t<=d}},z=e=>{const t=Number(e.substring(0,4)),o=Number(e.substring(5,7))-1,n=Number(e.substring(8,10));return new Date(t,o,n).getTime()},O=e=>`${e.getFullYear()}-${V(e.getMonth()+1,2)}-${V(e.getDate(),2)}`,V=(e,t)=>{let o=String(e);for(;o.length<t;)o=`0${o}`;return o},Y=(e,t,o)=>{let n=0;e.addEventListener("click",(e=>{setTimeout((()=>{window.performance.now()-n>=500&&t(e)}),200)})),e.addEventListener("dblclick",(e=>{n=window.performance.now(),o(e)}))},X=(e,t,o)=>Math.min(Math.max(e,t),o)}},e=>{e.O(0,[502],(()=>e(e.s=44))),e.O()}]);